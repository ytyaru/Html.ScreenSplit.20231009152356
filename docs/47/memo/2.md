# 遅延ロード 　原稿テキストファイルを読み込むのに時間がかかる。 * `fetch`APIによるファイル読込 * TextBlockによるテキスト分割　←ここが超遅い！ * 二行以上の空行ごとにテキストを配列化 　10万字300KBで15秒ほどかかった。よって文字量、ファイルサイズ、時間は次の通りと思われる。

* 10万字300KB15秒
* 1万字30KB1.5秒
* 5千字15KB0.75秒

## 解決案

* アルゴリズムを見直す
* 非同期にする
* イテレータ（ジェネレータ）にする
* ファイル分割する（1ファイル100KB未満）

## データ

　原稿テキストはテキストファイルから取得する。

観点／原稿データ形式|リテラルテキスト|テキストファイル|SQLite3|RDBMS
--------------------|----------------|----------------|-------|-----
リビジョン管理|△|○|△|✖
ダウンロード|△|○|△|✖
テキスト検索|△|△|○|○
テキスト集計|✖||✖|○|○

　テキストファイルにする理由は以下の通り。

* HTML,CSS,JSソースコードと分離できてリビジョン管理しやすい
* URL指定してコンテンツをDLしやすい（ファイルサイズが大きすぎず、コンテンツの区切りがよい単位である）

　ファイルを複数に分割したほうが管理しやすいが、結合したほうがダウンロードが高速な上にリンク切れしたとき中途半端にならなずに済む。

項目|ファイル分割|ファイル結合|補足
----|------------|------------|----
リビジョン管理|○|△|修正範囲が狭いほうが修正箇所を識別しやすく修正しやすく修正ミスも起きにくい
ダウンロード|△|○|ファイル数が少ないほうがHTTPS通信回数が少なく読込回数も少なく高速かつ構造も単純で実装が楽

　分割と結合の両方を用意しておき、ツールによって分割から結合、結合から分割、の各ファイルを作成するようにすれば両立できるか。

## イテレータ

* 一気にテキストブロック配列を作成する（同期）
* 一気にテキストブロック配列を作成する（イテレータ。一ブロックごとに返す。ロード完了まではブロックが増加しつづける）
* 押下ごとにテキストブロックを一画面分だけ取得する（イテレータ）


## 名前

本みたい,めくれる,ぺらり
web,html,responsive,flex,screen
book,novel,text
page,split

pagtex
pgtx
pgx
pag
pagetext
pageweb
bookweb
webook
text-page-web

bookeen
bookeen(book,screen)
hon
honja（本,Japan,本じゃ）
mekuri


